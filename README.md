# Robust Parameter Design Based on Time-Consuming Multi-fidelity Simulations with Autoregressive Shifted Log Loss Gaussian Process Model

This repository contains the source code for the paper “Robust Parameter Design Based on Time-Consuming Multi-fidelity Simulations with Autoregressive Shifted Log Loss Gaussian Process Model.”

Robust parameter design is a quality improvement method to mitigate the effect of input noise by minimizing the expected quality loss (EQL). To reduce simulation time in RPD based on bi-fidelity simulations, the autoregressive shifted log loss Gaussian process (ASLLGP) model is proposed to estimate the high-fidelity (HF) EQL using HF and low-fidelity (LF) simulation data. The excellent performance of the proposed model is illustrated with two examples. Descriptions on how to run the codes to reproduce the results for the two examples are presented as follows. 

**Requirements: Matlab R2020a, Global Optimization Toolbox, Parallel Computing Toolbox.**

Please open and run the `ShaftCompare3methods.m` file to get five performance measures in predicting EQL obtained with the ASLLGP, ALL, and AGPL models for the shaft example as in Table 2. The code also compares the three multi-fidelity models and the corresponding single-fidelity models by predicting the EQL as shown in Table 3.

The `ShaftGridOptimizationEQL.m` file gives the plots of the posterior mean (point predictor), and lower and upper 95% credible limits for the EQL given by the ASLLGP, ALL and AGPL models versus the control factor x_c, as shown in Figure 3.

The `PiezoCompare3methods.m` file gets five performance measures in predicting EQL obtained with the ASLLGP, ALL, and AGPL models for the piezoelectric actuator example as in Table 5. The code also compares the mean and standard error of the true EQL at the estimated optimal control-factor setting given by each of the ASLLGP, ALL and AGPL models as shown in Table 6.

The `PiezoContourPlotsofEQL.m` file gives the contour plots of the posterior mean (point predictor) for the EQL given by the ASLLGP, ALL, and AGPL models versus the control factor x_c=(x_1,x_2), as shown in Figure 5.

The `100 designs for the shaft example.mat` file gives the 100 maximin nested Latin hypercube designs generated by the `ShaftDesignPoints.m`.

The `100 designs for the piezoelectric actuator example.mat` file gives the 100 maximin nested Latin hypercube designs generated by the `PiezoDesignPoints.m`.

The `200 test points for the shaft example.mat` file gives the 200 test points used in Table 2 and Table 3 generated by the `ShaftTestpoints.m`.

The `400 test points and 2D grid points.mat` file gives the 400 test points used in Table 5 and the high-fidelity tip deflection and the mass of the beam on a 201×201 grid used in Table 6, which are generated by the `PiezoTestpoints.m`.

**Other Matlab scripts**

`AGPLexpectedloss.m`: Function for computing the EQL with the AGPL model.

`ALLexpectedloss.m`: Function for computing the EQL with the ALL model.

`ASLLexpectedloss.m`: Function for computing the EQL with the ASLLGP model.

`correlax.m`: Function for computing the correlations over the input domain.

`gpfit1level.m`: Function used to fit the posterior process G_l (∙).

`gpfit2level.m`: Function used to fit the posterior process G (∙).

`gpfitASLL1level.m`: Function used to fit the posterior process S_l (∙).

`gpfitASLL2level.m`: Function used to fit the posterior process S(∙).

`gppredict.m`: Function used to compute point and interval predictions of the ASLLGP/ALL/ AGPL emulator.  

`invandlogdet.m`: Function used to compute the inverse and the log determinant of a positive definite matrix.

`lgwt.m`:	please	download	this	file	from https://ww2.mathworks.cn/matlabcentral/fileexchange/4540-legendre-gauss-quadrature- weights-and-nodes, and place it in the same 
folder as the other scripts.

`lossShaft.m`: Function for computing the loss function of the robust shaft design.

`lossPiezo.m`: Function for computing the loss function of  the robust piezoelectric actuator design.

`NestedLHD.m`: Function for generating the maximin nested Latin hypercube design.

`PiezoelectricActuator.m`: Function used to compute the high-fidelity and low-fidelity tip deflection and the mass of the beam.

