# Robust Parameter Design Based on Time-Consuming Multi-fidelity Simulations with Autoregressive Shifted Log Loss Gaussian Process Model

This repository contains the source code for the paper “Robust Parameter Design Based on Time-Consuming Multi-fidelity Simulations with Autoregressive Shifted Log Loss Gaussian Process Model.”

Robust parameter design is a quality improvement method to mitigate the effect of input noise by minimizing the expected quality loss (EQL). To reduce simulation time in RPD based on bi-fidelity simulations, the autoregressive shifted log loss Gaussian process (ASLLGP) model is proposed to estimate the high-fidelity (HF) EQL using HF and low-fidelity (LF) simulation data. The excellent performance of the proposed model is illustrated with two examples. Descriptions on how to run the codes to reproduce the results for the two examples are presented as follows. 

**Requirements: Matlab R2020a, Global Optimization Toolbox, Parallel Computing Toolbox.**

**Instructions for reproducing the results in Example 1:**

Please open and run the `ShaftCompare3methods.m` script to get the summaries of the five EQL prediction performance measures for the ASLLGP, ALL, and AGPL models as given in Table 2. The code also gives the results in Table 3.

Run the `ShaftGridOptimizationEQL.m` script to construct Figure 3, i.e., which is a plot of the posterior mean, and lower and upper 95% credible limits for the EQL given by the ASLLGP, ALL and AGPL models fitted with data from one nested design versus $`x_c`$.

**Instructions for reproducing the results in Example 2:**

Please open and run the `PiezoCompare3methods.m` script to get the summaries of the five EQL prediction performance measures for the ASLLGP, ALL, and AGPL models as given in Table 5. The code also gives the results in Table 6.

Run the `PiezoContourPlotsofEQL.m` script to construct Figure 5, which is a contour plot of the posterior mean, and lower and upper 95% credible limits for the EQL given by the ASLLGP, ALL and AGPL models fitted with data from one nested design versus $`x_c=(x_1,x_2)`$.

**Data Files**

**1.	Example 1**

The `ShaftOutput.mat` file gives the maximum Von Mises stress outputs of the HF and LF simulators (stored in variable stress) and the mass of the small shaft output of both simulators (stored in variable mass) on the $`{11}^2`$ grid $`{\{0,0.1,…,1}\}^2`$.

The `100 designs for the piezoelectric actuator example.mat` file gives the 100 maximin nested Latin hypercube designs generated by the `PiezoDesignPoints.m`.

The `200 test points for the shaft example.mat` file gives the 200 test points used in Table 2 and Table 3 generated by the `ShaftTestpoints.m`.

The `400 test points and 2D grid points.mat` file gives the 400 test points used in Table 5 and the high-fidelity tip deflection and the mass of the beam on a 201×201 grid used in Table 6, which are generated by the `PiezoTestpoints.m`.

**Other Matlab scripts**

`AGPLexpectedloss.m`: Function for computing the EQL with the AGPL model.

`ALLexpectedloss.m`: Function for computing the EQL with the ALL model.

`ASLLexpectedloss.m`: Function for computing the EQL with the ASLLGP model.

`correlax.m`: Function for computing the correlations over the input domain.

`gpfit1level.m`: Function used to fit the posterior process G_l (∙).

`gpfit2level.m`: Function used to fit the posterior process G (∙).

`gpfitASLL1level.m`: Function used to fit the posterior process S_l (∙).

`gpfitASLL2level.m`: Function used to fit the posterior process S(∙).

`gppredict.m`: Function used to compute point and interval predictions of the ASLLGP/ALL/ AGPL emulator.  

`invandlogdet.m`: Function used to compute the inverse and the log determinant of a positive definite matrix.

`lgwt.m`:	please	download	this	file	from https://ww2.mathworks.cn/matlabcentral/fileexchange/4540-legendre-gauss-quadrature- weights-and-nodes, and place it in the same 
folder as the other scripts.

`lossShaft.m`: Function for computing the loss function of the robust shaft design.

`lossPiezo.m`: Function for computing the loss function of  the robust piezoelectric actuator design.

`NestedLHD.m`: Function for generating the maximin nested Latin hypercube design.

`PiezoelectricActuator.m`: Function used to compute the high-fidelity and low-fidelity tip deflection and the mass of the beam.

